{% extends "base.html" %}

{% block title %}Reply Insights - SendBaba{% endblock %}

{% block content %}
<div class="p-6 md:p-8">
    <div class="mb-8">
        <h1 class="text-3xl font-bold mb-2">ğŸ§  AI Insights</h1>
        <p class="text-gray-600">Smart recommendations based on your reply data</p>
    </div>
    
    <!-- Insights Cards -->
    <div class="grid md:grid-cols-2 gap-6 mb-8">
        {% for insight in insights %}
        <div class="bg-white rounded-lg p-6 shadow-sm border-l-4 
                    {% if insight.type == 'critical' %}border-red-500
                    {% elif insight.type == 'warning' %}border-yellow-500
                    {% elif insight.type == 'opportunity' %}border-green-500
                    {% else %}border-blue-500{% endif %}">
            <div class="flex items-start">
                <div class="mr-4 text-3xl">
                    {% if insight.type == 'critical' %}ğŸš¨
                    {% elif insight.type == 'warning' %}âš ï¸
                    {% elif insight.type == 'opportunity' %}ğŸ’¡
                    {% else %}â„¹ï¸{% endif %}
                </div>
                <div class="flex-1">
                    <h3 class="font-semibold text-lg mb-2">{{ insight.title }}</h3>
                    <p class="text-gray-700 mb-3">{{ insight.message }}</p>
                    <div class="bg-gray-50 rounded-lg p-3">
                        <div class="text-sm font-semibold text-purple-600 mb-1">Recommended Action:</div>
                        <div class="text-sm text-gray-700">{{ insight.action }}</div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
        
        {% if not insights %}
        <div class="col-span-2 bg-white rounded-lg p-12 text-center">
            <div class="text-6xl mb-4">ğŸ‰</div>
            <h3 class="text-xl font-semibold mb-2">All Good!</h3>
            <p class="text-gray-600">No critical insights at the moment. Keep up the great work!</p>
        </div>
        {% endif %}
    </div>
    
    <!-- Reply Patterns -->
    {% if patterns %}
    <div class="bg-white rounded-lg p-6 shadow-sm mb-8">
        <h2 class="text-xl font-bold mb-6">ğŸ“ˆ Reply Patterns</h2>
        
        <div class="grid md:grid-cols-4 gap-6 mb-6">
            <div>
                <div class="text-3xl font-bold text-purple-600 mb-2">{{ patterns.total_replies }}</div>
                <div class="text-sm text-gray-600">Total Replies</div>
            </div>
            <div>
                <div class="text-3xl font-bold text-green-600 mb-2">{{ patterns.response_rate }}%</div>
                <div class="text-sm text-gray-600">Response Rate</div>
            </div>
            <div>
                <div class="text-3xl font-bold text-blue-600 mb-2">{{ patterns.avg_response_time_hours|round(1) }}h</div>
                <div class="text-sm text-gray-600">Avg Response Time</div>
            </div>
            <div>
                <div class="flex text-2xl justify-around">
                    <span>ğŸ˜Š {{ patterns.sentiment_breakdown.get('positive', 0) }}</span>
                    <span>ğŸ˜ {{ patterns.sentiment_breakdown.get('neutral', 0) }}</span>
                    <span>ğŸ˜ {{ patterns.sentiment_breakdown.get('negative', 0) }}</span>
                </div>
                <div class="text-sm text-gray-600 text-center">Sentiment</div>
            </div>
        </div>
        
        <!-- Category Breakdown -->
        <div class="mb-6">
            <h3 class="font-semibold mb-3">Reply Categories</h3>
            <div class="space-y-2">
                {% for category, count in patterns.category_breakdown.items() %}
                <div class="flex items-center">
                    <div class="w-32 text-sm text-gray-700">{{ category|title|replace('_', ' ') }}</div>
                    <div class="flex-1 bg-gray-200 rounded-full h-4">
                        {% set percentage = (count / patterns.total_replies * 100)|round %}
                        <div class="bg-purple-600 h-4 rounded-full" style="width: {{ percentage }}%"></div>
                    </div>
                    <div class="w-16 text-right text-sm font-semibold">{{ count }}</div>
                </div>
                {% endfor %}
            </div>
        </div>
        
        <!-- Common Questions -->
        {% if patterns.common_questions %}
        <div>
            <h3 class="font-semibold mb-3">Most Asked Questions</h3>
            <div class="space-y-2">
                {% for question in patterns.common_questions %}
                <div class="bg-gray-50 rounded-lg p-3 text-sm">
                    â“ {{ question }}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
    {% endif %}
    
    <!-- AI Recommendations -->
    <div class="bg-gradient-to-r from-purple-500 to-blue-500 rounded-lg p-6 text-white">
        <h2 class="text-xl font-bold mb-4">ğŸ¤– AI-Powered Recommendations</h2>
        <div class="grid md:grid-cols-3 gap-4">
            <div class="bg-white bg-opacity-20 rounded-lg p-4">
                <div class="text-2xl mb-2">ğŸ“</div>
                <div class="font-semibold mb-1">Create FAQ</div>
                <div class="text-sm opacity-90">Turn common questions into FAQ articles</div>
            </div>
            <div class="bg-white bg-opacity-20 rounded-lg p-4">
                <div class="text-2xl mb-2">âš¡</div>
                <div class="font-semibold mb-1">Enable Auto-Responses</div>
                <div class="text-sm opacity-90">Respond to 80% of replies automatically</div>
            </div>
            <div class="bg-white bg-opacity-20 rounded-lg p-4">
                <div class="text-2xl mb-2">ğŸ“Š</div>
                <div class="font-semibold mb-1">Sentiment Alert</div>
                <div class="text-sm opacity-90">Get notified of negative replies instantly</div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
