{% extends "hub/base.html" %}
{% set active_page = 'organizations' %}

{% block title %}Organizations{% endblock %}

{% block content %}
<div class="mb-6">
    <h1 class="text-xl lg:text-2xl font-bold text-gray-800">Organizations</h1>
    <p class="text-gray-500 text-sm">View all registered organizations</p>
</div>

<!-- Organizations Grid -->
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6" id="orgs-grid">
    <!-- Organizations populated by JS -->
</div>
{% endblock %}

{% block scripts %}
<script>
    async function loadOrganizations() {
        try {
            const res = await fetch('/hub/api/organizations');
            const data = await res.json();
            
            if (data.success) {
                const grid = document.getElementById('orgs-grid');
                grid.innerHTML = data.organizations.map(o => `
                    <div class="bg-white rounded-xl shadow-sm p-4 lg:p-6">
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-10 h-10 lg:w-12 lg:h-12 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0">
                                <span class="text-blue-600 font-bold">${(o.name || 'O')[0].toUpperCase()}</span>
                            </div>
                            <div class="min-w-0">
                                <h3 class="font-bold text-sm lg:text-base truncate">${o.name || 'Unnamed'}</h3>
                                <p class="text-xs text-gray-500">${o.created_at ? new Date(o.created_at).toLocaleDateString() : ''}</p>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-2 lg:gap-4">
                            <div class="bg-gray-50 rounded-lg p-2 lg:p-3 text-center">
                                <p class="text-lg lg:text-2xl font-bold text-blue-600">${o.user_count || 0}</p>
                                <p class="text-xs text-gray-500">Users</p>
                            </div>
                            <div class="bg-gray-50 rounded-lg p-2 lg:p-3 text-center">
                                <p class="text-lg lg:text-2xl font-bold text-green-600">${o.domain_count || 0}</p>
                                <p class="text-xs text-gray-500">Domains</p>
                            </div>
                            <div class="bg-gray-50 rounded-lg p-2 lg:p-3 text-center">
                                <p class="text-lg lg:text-2xl font-bold text-purple-600">${formatNumber(o.email_count || 0)}</p>
                                <p class="text-xs text-gray-500">Emails</p>
                            </div>
                            <div class="bg-gray-50 rounded-lg p-2 lg:p-3 text-center">
                                <p class="text-lg lg:text-2xl font-bold text-orange-600">${o.campaign_count || 0}</p>
                                <p class="text-xs text-gray-500">Campaigns</p>
                            </div>
                        </div>
                    </div>
                `).join('') || '<div class="col-span-full text-center text-gray-500 py-8">No organizations found</div>';
            }
        } catch (e) { console.error(e); }
    }

    loadOrganizations();
</script>
{% endblock %}
